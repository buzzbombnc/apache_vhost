---
- import_tasks: validate.yml

- name: "build a temp"
  tempfile:
    state: directory
  register: tmpdir

- set_fact:
    tmpdir: "{{ tmpdir.path }}"

- include_tasks: header.yml

# modules

- include_tasks: serverinfo.yml

# alias
# wsgi
# directory
# logging


- include_tasks: footer.yml

- name: "assemble the conf file"
  assemble:
    src: "{{ tmpdir }}"
    remote_src: true
    dest: "{{ tmpdir }}/output"
    regexp: "\\d*-.*"

- debug: var=tmpdir
